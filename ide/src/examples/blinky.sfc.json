{
  "$schema": "./schemas/sfc.schema.json",
  "name": "Blinky",
  "description": "ZPLC Golden Standard - Blinky in Sequential Function Chart (SFC)",
  "version": "1.0.0",
  
  "variables": {
    "local": [
      {
        "name": "LedState",
        "type": "BOOL",
        "initialValue": false,
        "comment": "Current LED state"
      }
    ],
    "outputs": [
      {
        "name": "LED_Output",
        "type": "BOOL",
        "address": "%Q0.0",
        "comment": "Physical LED output"
      }
    ]
  },

  "steps": [
    {
      "id": "step_init",
      "name": "Init",
      "isInitial": true,
      "position": { "x": 200, "y": 50 },
      "actions": [
        {
          "qualifier": "N",
          "actionName": "LED_OFF",
          "comment": "Ensure LED starts OFF"
        }
      ]
    },
    {
      "id": "step_led_on",
      "name": "LED_ON",
      "isInitial": false,
      "position": { "x": 200, "y": 250 },
      "actions": [
        {
          "qualifier": "N",
          "actionName": "SET_LED_ON",
          "comment": "Turn LED ON"
        }
      ]
    },
    {
      "id": "step_led_off",
      "name": "LED_OFF", 
      "isInitial": false,
      "position": { "x": 200, "y": 450 },
      "actions": [
        {
          "qualifier": "N",
          "actionName": "SET_LED_OFF",
          "comment": "Turn LED OFF"
        }
      ]
    }
  ],

  "transitions": [
    {
      "id": "trans_init_to_on",
      "fromStep": "step_init",
      "toStep": "step_led_on",
      "condition": "TRUE",
      "comment": "Immediately transition to ON state",
      "position": { "x": 200, "y": 150 }
    },
    {
      "id": "trans_on_to_off",
      "fromStep": "step_led_on",
      "toStep": "step_led_off",
      "condition": "step_led_on.T >= T#500ms",
      "comment": "After 500ms in ON state, transition to OFF",
      "position": { "x": 200, "y": 350 }
    },
    {
      "id": "trans_off_to_on",
      "fromStep": "step_led_off",
      "toStep": "step_led_on",
      "condition": "step_led_off.T >= T#500ms",
      "comment": "After 500ms in OFF state, transition to ON",
      "position": { "x": 400, "y": 350 }
    }
  ],

  "actions": [
    {
      "id": "SET_LED_ON",
      "name": "SET_LED_ON",
      "type": "ST",
      "body": "LedState := TRUE;\nLED_Output := LedState;"
    },
    {
      "id": "SET_LED_OFF",
      "name": "SET_LED_OFF",
      "type": "ST",
      "body": "LedState := FALSE;\nLED_Output := LedState;"
    },
    {
      "id": "LED_OFF",
      "name": "LED_OFF",
      "type": "ST",
      "body": "LedState := FALSE;\nLED_Output := FALSE;"
    }
  ],

  "metadata": {
    "author": "ZPLC Team",
    "created": "2024-12-23",
    "iecStandard": "IEC 61131-3",
    "notes": [
      "SFC step timing uses implicit .T property",
      "Action qualifiers: N=Non-stored, S=Set, R=Reset, L=Time Limited, D=Time Delayed",
      "This example uses the simplest N (Non-stored) qualifier"
    ]
  }
}
