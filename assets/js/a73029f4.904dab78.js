"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[7035],{5259(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>a,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"runtime/intro","title":"ZPLC v1.1: Technical Specification & Architecture","description":"Version: 1.1.0 (Stable)","source":"@site/docs/runtime/intro.md","sourceDirName":"runtime","slug":"/runtime/intro","permalink":"/ZPLC/docs/runtime/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/eduardojvieira/ZPLC/tree/master/docs/docs/runtime/intro.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Supported Boards","permalink":"/ZPLC/docs/hardware/pinouts"},"next":{"title":"ZPLC Virtual Machine - Instruction Set Architecture (ISA)","permalink":"/ZPLC/docs/runtime/isa"}}');var s=i(4848),t=i(8453);const l={},d="ZPLC v1.1: Technical Specification & Architecture",c={},o=[{value:"1. Executive Summary",id:"1-executive-summary",level:2},{value:"2. Supported Hardware Targets",id:"2-supported-hardware-targets",level:2},{value:"3. High-Level Architecture",id:"3-high-level-architecture",level:2},{value:"3.1 The Data Flow",id:"31-the-data-flow",level:3},{value:"4. The <code>.zplc</code> Binary Format",id:"4-the-zplc-binary-format",level:2},{value:"5. The ZPLC Core (Runtime)",id:"5-the-zplc-core-runtime",level:2},{value:"5.1 The Virtual Machine (VM)",id:"51-the-virtual-machine-vm",level:3},{value:"Memory Map",id:"memory-map",level:4},{value:"5.2 The Scheduler (v1.1+)",id:"52-the-scheduler-v11",level:3},{value:"Scan Cycle Visualization",id:"scan-cycle-visualization",level:4},{value:"5.3 Program Persistence (v1.1+)",id:"53-program-persistence-v11",level:3},{value:"6. Hardware Abstraction Layer (HAL)",id:"6-hardware-abstraction-layer-hal",level:2},{value:"6.1 Zephyr Integration Strategy (Primary)",id:"61-zephyr-integration-strategy-primary",level:3},{value:"7. Development Environment (Web IDE)",id:"7-development-environment-web-ide",level:2},{value:"8. Connectivity &amp; Security (v1.2 Scope)",id:"8-connectivity--security-v12-scope",level:2},{value:"8.1 Communication",id:"81-communication",level:3},{value:"8.2 Security Strategy",id:"82-security-strategy",level:3},{value:"9. Development Roadmap",id:"9-development-roadmap",level:2},{value:"1. The Infrastructure: &quot;Test First&quot; Environment",id:"1-the-infrastructure-test-first-environment",level:2},{value:"2. Phase-by-Phase Verification",id:"2-phase-by-phase-verification",level:2},{value:"Phase 0: Core Skeleton &amp; Build System",id:"phase-0-core-skeleton--build-system",level:3},{value:"Phase 1: ST Compiler &amp; VM Instruction Set",id:"phase-1-st-compiler--vm-instruction-set",level:3},{value:"Phase 2: Visual Languages",id:"phase-2-visual-languages",level:3},{value:"Phase 3: Runtime Maturity",id:"phase-3-runtime-maturity",level:3},{value:"Phase 4: Connectivity &amp; Security",id:"phase-4-connectivity--security",level:3}];function h(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"zplc-v11-technical-specification--architecture",children:"ZPLC v1.1: Technical Specification & Architecture"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Version:"})," 1.1.0 (Stable)\n",(0,s.jsx)(n.strong,{children:"Target:"})," Open Source Industrial Automation\n",(0,s.jsx)(n.strong,{children:"Core Philosophy:"})," One Execution Core, Any Runtime."]}),"\n",(0,s.jsx)(n.h2,{id:"1-executive-summary",children:"1. Executive Summary"}),"\n",(0,s.jsx)(n.p,{children:"ZPLC is a portable, deterministic PLC runtime environment powered by Zephyr RTOS for embedded targets and native OS layers for desktop/server hosting. It is designed to bring modern software development practices\u2014including CI/CD pipelines, compact binary deployment, and open interoperability via PLCopen XML\u2014to the industrial floor."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:'The "v1.1" Features:'})," A fully functional runtime supporting all 5 IEC 61131-3 languages, capable of running real hardware I/O or in-browser simulations, with industrial-grade determinism. Now includes ",(0,s.jsx)(n.strong,{children:"multitask scheduling"})," and ",(0,s.jsx)(n.strong,{children:"NVS persistence"}),"."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"2-supported-hardware-targets",children:"2. Supported Hardware Targets"}),"\n",(0,s.jsx)(n.p,{children:"ZPLC v1.1 officially supports the following reference boards. CI/CD pipelines must ensure compilation succeeds for all defined targets."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Board Name"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"SoC"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Zephyr Board ID"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Notes"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"Arduino GIGA R1"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"STM32H747XI (Cortex-M7/M4)"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"arduino_giga_r1/stm32h747xx/m7"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Dual-core (targeting M7)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"ESP32-S3 DevKit-C"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"ESP32-S3 (Xtensa LX7)"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"esp32s3_devkitc"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"WiFi/BLE capable"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"STM32 Nucleo-H743ZI"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"STM32H743ZI (Cortex-M7)"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"nucleo_h743zi"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"High-perf industrial Ref"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"Raspberry Pi Pico"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"RP2040 (Cortex-M0+)"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"rpi_pico"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Low-cost, tested target"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"QEMU (Simulation)"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Cortex-M3"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"mps2/an385"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"CI Default"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"3-high-level-architecture",children:"3. High-Level Architecture"}),"\n",(0,s.jsxs)(n.p,{children:['The system follows a "Compiler-VM" architecture. The IDE acts as the compiler/linker, producing a hardware-agnostic bytecode package (',(0,s.jsx)(n.code,{children:".zplc"}),") which is consumed by the ZPLC Core."]}),"\n",(0,s.jsxs)(n.p,{children:["For embedded targets, ",(0,s.jsx)(n.strong,{children:"Zephyr RTOS is the primary citizen"}),". ZPLC is designed to be a ",(0,s.jsx)(n.strong,{children:"Zephyr Module"})," that can be effortlessly dropped into any board supported by Zephyr."]}),"\n",(0,s.jsx)(n.h3,{id:"31-the-data-flow",children:"3.1 The Data Flow"}),"\n",(0,s.jsx)(n.mermaid,{value:'graph TD\n    subgraph "Development Host (Web IDE)"\n        User[User Logic] --\x3e|ST/LD/FBD/SFC/IL| Parsers\n        Parsers --\x3e|Normalize| IEC_IR[Internal IR]\n        IEC_IR --\x3e|Optimization| Compiler\n        Compiler --\x3e|Link & Pack| ZPLC_Bin[.zplc Package]\n    end\n\n    ZPLC_Bin --\x3e|Deploy via HTTP/Serial| Runtime\n\n    subgraph "Target Runtime (Device)"\n        Loader[Package Loader] --\x3e|Verify & Load| VM[ZPLC Virtual Machine]\n        VM <--\x3e|Read/Write| ProcessImg[Process Image]\n        \n        subgraph "Hardware Abstraction Layer (HAL)"\n            ProcessImg <--\x3e|Map| Drivers[IO Drivers]\n            VM --\x3e|Schedule| Timers[OS Timers]\n        end\n    end'}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h2,{id:"4-the-zplc-binary-format",children:["4. The ",(0,s.jsx)(n.code,{children:".zplc"})," Binary Format"]}),"\n",(0,s.jsx)(n.p,{children:"This is the contract between the IDE and the Runtime. It is a compact, serialized binary format."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Structure Definition:"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Section"}),(0,s.jsx)(n.th,{children:"Content"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Header"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"0x5A504C43"})," (Magic), Version, CRC32, Flags"]}),(0,s.jsx)(n.td,{children:"Validity check and version compatibility."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Meta"})}),(0,s.jsx)(n.td,{children:"Project Name, Build TS, Compiler Ver, Git Hash"}),(0,s.jsx)(n.td,{children:"Traceability."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SymTable"})}),(0,s.jsx)(n.td,{children:"Variable IDs, Types, Scopes (Global/Local), Retentive Flags"}),(0,s.jsx)(n.td,{children:"Memory layout definition."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"TaskMap"})}),(0,s.jsx)(n.td,{children:"ID, Type (Cyclic/Event), Interval (\u03bcs), Priority, Entry Point"}),(0,s.jsxs)(n.td,{children:["Tells the scheduler ",(0,s.jsx)(n.em,{children:"when"})," to run code."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Bytecode"})}),(0,s.jsx)(n.td,{children:"Linearized VM Instructions (SSA-based)"}),(0,s.jsx)(n.td,{children:"The executable logic. Unified format for all languages."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"IOMap"})}),(0,s.jsx)(n.td,{children:"Logical ID \u2194 Abstract Channel"}),(0,s.jsxs)(n.td,{children:["Example: ",(0,s.jsx)(n.code,{children:"Var_StartBtn"})," maps to ",(0,s.jsx)(n.code,{children:"DIN_0"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Debug"})}),(0,s.jsx)(n.td,{children:"(Optional) Source Line Mapping, Symbol Names"}),(0,s.jsx)(n.td,{children:"Strippable for production, needed for IDE debugging."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Signature"})}),(0,s.jsx)(n.td,{children:"(Optional) Crypto Signature"}),(0,s.jsx)(n.td,{children:"Security verification (v1.2 Roadmap)."})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"5-the-zplc-core-runtime",children:"5. The ZPLC Core (Runtime)"}),"\n",(0,s.jsxs)(n.p,{children:["The Core is ANSI C99, strictly standard-compliant, designed to be compiled as a library (",(0,s.jsx)(n.code,{children:"libzplc_core"}),")."]}),"\n",(0,s.jsx)(n.h3,{id:"51-the-virtual-machine-vm",children:"5.1 The Virtual Machine (VM)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Instruction Set:"})," Stack-based, optimized for boolean logic and arithmetic. ",(0,s.jsx)(n.strong,{children:"63 opcodes"})," total."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Unified IR:"})," Structured Text (ST) and Ladder (LD) ultimately compile down to the same JUMP / LOAD / STORE / AND / OR opcodes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Memory Model:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Process Image:"})," A contiguous block of memory for I/O snapshots."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Retentive Memory:"})," A dedicated block backed by HAL storage (NVS / Flash)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Work Memory:"})," Stack/Heap for temporary calculation (strictly bounded, per-task)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"memory-map",children:"Memory Map"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    ZPLC Memory Map (64KB Total)                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502     IPI     \u2502     OPI     \u2502  Work Memory  \u2502      Retentive          \u2502\n\u2502 0x0000-0x0FFF\u2502 0x1000-0x1FFF\u2502 0x2000-0x3FFF \u2502    0x4000-0x4FFF        \u2502\n\u2502    4 KB     \u2502    4 KB     \u2502     8 KB      \u2502       4 KB              \u2502\n\u2502   (Inputs)  \u2502  (Outputs)  \u2502   (per-task)  \u2502  (NVS-backed)           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                        Code Segment                                 \u2502\n\u2502                      0x5000-0xFFFF (44 KB)                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Region"}),(0,s.jsx)(n.th,{children:"Base"}),(0,s.jsx)(n.th,{children:"Size"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"IPI"})}),(0,s.jsx)(n.td,{children:"0x0000"}),(0,s.jsx)(n.td,{children:"4 KB"}),(0,s.jsx)(n.td,{children:"Input Process Image - snapshot of all inputs at cycle start"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"OPI"})}),(0,s.jsx)(n.td,{children:"0x1000"}),(0,s.jsx)(n.td,{children:"4 KB"}),(0,s.jsx)(n.td,{children:"Output Process Image - buffered outputs flushed at cycle end"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Work"})}),(0,s.jsx)(n.td,{children:"0x2000"}),(0,s.jsx)(n.td,{children:"8 KB"}),(0,s.jsx)(n.td,{children:"Per-task temporary variables and call stack"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Retain"})}),(0,s.jsx)(n.td,{children:"0x4000"}),(0,s.jsx)(n.td,{children:"4 KB"}),(0,s.jsx)(n.td,{children:"NVS-backed persistent variables (survives power loss)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Code"})}),(0,s.jsx)(n.td,{children:"0x5000"}),(0,s.jsx)(n.td,{children:"44 KB"}),(0,s.jsx)(n.td,{children:"Bytecode storage"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"52-the-scheduler-v11",children:"5.2 The Scheduler (v1.1+)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Execution Discipline:"})," Priority-based preemptive scheduling with configurable task intervals."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Task Types:"})," CYCLIC (periodic) and EVENT (future)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cycle:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Input Latch:"})," Call ",(0,s.jsx)(n.code,{children:"HAL_IO_Read()"})," to update Process Image (IPI)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Logic Execution:"})," Run tasks sorted by priority, each with isolated work memory."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Output Latch:"})," Call ",(0,s.jsx)(n.code,{children:"HAL_IO_Write()"})," to flush Process Image (OPI)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Housekeeping:"})," Handle Comms/Debug messages (time budgeted)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"scan-cycle-visualization",children:"Scan Cycle Visualization"}),"\n",(0,s.jsx)(n.mermaid,{value:'graph LR\n    subgraph "One Scan Cycle (10-100ms typical)"\n        direction LR\n        A["\ud83d\udce5 Input Scan\\n< 100\u03bcs"] --\x3e B["\u2699\ufe0f Logic Execution\\n< 10ms"]\n        B --\x3e C["\ud83d\udce4 Output Update\\n< 100\u03bcs"]\n        C --\x3e D["\ud83d\udd27 Housekeeping\\n< 1ms"]\n    end\n    D --\x3e A\n    \n    style A fill:#22d3ee,color:#000\n    style B fill:#a855f7,color:#fff\n    style C fill:#27ca40,color:#000\n    style D fill:#64748b,color:#fff'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Timing Guarantees:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Input/Output phases complete in microseconds"}),"\n",(0,s.jsx)(n.li,{children:"Logic execution is deterministic (same input = same output)"}),"\n",(0,s.jsx)(n.li,{children:"Jitter < 1ms on Zephyr RTOS targets"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"53-program-persistence-v11",children:"5.3 Program Persistence (v1.1+)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Auto-Save:"})," Programs are saved to NVS when ",(0,s.jsx)(n.code,{children:"zplc start"})," is called."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Auto-Restore:"})," On boot, the runtime checks for saved programs and loads them automatically."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Storage Keys:"})," ",(0,s.jsx)(n.code,{children:"code_len"})," (4 bytes), ",(0,s.jsx)(n.code,{children:"code"})," (up to 4KB), ",(0,s.jsx)(n.code,{children:"retain"})," (future)."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"6-hardware-abstraction-layer-hal",children:"6. Hardware Abstraction Layer (HAL)"}),"\n",(0,s.jsx)(n.p,{children:"The Core never calls hardware directly. It calls the HAL."}),"\n",(0,s.jsx)(n.h3,{id:"61-zephyr-integration-strategy-primary",children:"6.1 Zephyr Integration Strategy (Primary)"}),"\n",(0,s.jsxs)(n.p,{children:["ZPLC integrates with Zephyr as a ",(0,s.jsx)(n.strong,{children:"Module"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DeviceTree Bindings:"})," I/O channels are defined in ",(0,s.jsx)(n.code,{children:".dts"})," overlay files."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Kconfig:"})," All runtime limits (stack size, memory pool) are configurable via Kconfig."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Shell:"})," ZPLC provides a shell module (",(0,s.jsx)(n.code,{children:"zplc load"}),", ",(0,s.jsx)(n.code,{children:"zplc start"}),", ",(0,s.jsx)(n.code,{children:"zplc persist"}),") for management."]}),"\n"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Function"}),(0,s.jsx)(n.th,{children:"Zephyr Implementation"}),(0,s.jsx)(n.th,{children:"Desktop (Linux/Win) Implementation"}),(0,s.jsx)(n.th,{children:"WASM Implementation"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"zplc_hal_tick()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"k_uptime_get()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"clock_gettime"})}),(0,s.jsxs)(n.td,{children:["JS ",(0,s.jsx)(n.code,{children:"performance.now()"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"zplc_hal_sleep()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"k_sleep()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"usleep()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Atomics.wait"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"zplc_hal_gpio_read()"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"gpio_pin_get_dt()"})," (via binding)"]}),(0,s.jsx)(n.td,{children:"Shared Mem / Simulation"}),(0,s.jsx)(n.td,{children:"JS Object"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"zplc_hal_socket()"})}),(0,s.jsxs)(n.td,{children:["Zephyr BSD Sockets (",(0,s.jsx)(n.code,{children:"net_context"}),")"]}),(0,s.jsx)(n.td,{children:"BSD Sockets"}),(0,s.jsx)(n.td,{children:"WebSockets"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"zplc_hal_persist_save()"})}),(0,s.jsxs)(n.td,{children:["NVS (",(0,s.jsx)(n.code,{children:"nvs_write"}),")"]}),(0,s.jsxs)(n.td,{children:["File (",(0,s.jsx)(n.code,{children:"retain.bin"}),")"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"localStorage"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"zplc_hal_persist_load()"})}),(0,s.jsxs)(n.td,{children:["NVS (",(0,s.jsx)(n.code,{children:"nvs_read"}),")"]}),(0,s.jsx)(n.td,{children:"File read"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"localStorage"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"zplc_hal_persist_delete()"})}),(0,s.jsxs)(n.td,{children:["NVS (",(0,s.jsx)(n.code,{children:"nvs_delete"}),")"]}),(0,s.jsx)(n.td,{children:"File delete"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"localStorage.removeItem"})})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"7-development-environment-web-ide",children:"7. Development Environment (Web IDE)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Stack:"})," TypeScript, React (Frontend), Bun (Runtime)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Project Model:"})," JSON-based project files with task definitions."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Editors:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ST:"})," Monaco Editor with custom language server."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Visual (LD/FBD/SFC):"})," React Flow-based implementation utilizing a common graph model."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Simulation:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The IDE includes a compiled WASM version of ",(0,s.jsx)(n.code,{children:"zplc_core"}),"."]}),"\n",(0,s.jsx)(n.li,{children:'"Run Simulation" launches the VM strictly in the browser tab.'}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"8-connectivity--security-v12-scope",children:"8. Connectivity & Security (v1.2 Scope)"}),"\n",(0,s.jsx)(n.h3,{id:"81-communication",children:"8.1 Communication"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Modbus TCP Server:"})," Standard implementation. Map internal vars to Holding Registers/Coils via config."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"MQTT Client:"}),' "Publish on Change" for tagged variables (Sparkplug B compliant).']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Debug Protocol:"})," WebSocket protocol for Watch/Force/Upload."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"82-security-strategy",children:"8.2 Security Strategy"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Authentication:"})," SRP or JWT based auth for the Debug Protocol."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Role Based Access Control (RBAC):"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"Viewer:"})," Read-only Watch."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"Operator:"})," Read/Write specific runtime parameters."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"Engineer:"})," Full Upload/Download/Force capability."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Crypto:"})," Use MbedTLS (on Zephyr) or OpenSSL (on Host) for TLS transport."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"9-development-roadmap",children:"9. Development Roadmap"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Phase 1.0 (Completed)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ISA & VM"}),": 63 opcodes, 32-bit stack, IEEE 754 float support."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Visual IDE"}),": Reactive editors for LD, FBD, and SFC."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TS Compiler"}),": Structured Text to Bytecode transpilation."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"WASM Simulation"}),": In-browser execution of the C core."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Serial Loader"}),": Real-time program injection into Zephyr targets."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Phase 1.1 (Completed)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Multitask Scheduler"}),": Priority-based concurrent task execution."]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Program Persistence"}),": NVS-backed storage survives power cycles."]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Shell Commands"}),": ",(0,s.jsx)(n.code,{children:"zplc persist info/clear"})," for managing stored programs."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Phase 1.2 (Target: Q2 2026)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Industrial Connectivity"}),": Modbus TCP/RTU server and client."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cloud Integration"}),': MQTT "Sparkplug B" compliant client.']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Retentive Variables"}),": NVS-backed RETAIN memory for process data."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Security"}),": Bytecode signing and encrypted debug transport."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h1,{id:"quality-assurance--verification-plan",children:"Quality Assurance & Verification Plan"}),"\n",(0,s.jsx)(n.h2,{id:"1-the-infrastructure-test-first-environment",children:'1. The Infrastructure: "Test First" Environment'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"CI/CD Pipeline (GitHub Actions / GitLab CI):"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Static Analysis:"})," Run ",(0,s.jsx)(n.code,{children:"clang-tidy"})," (C) and ",(0,s.jsx)(n.code,{children:"eslint"})," (TS) on every commit. Enforce coding standards strictly."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Unit Tests:"})," Run on host (Linux/Windows) for logic verification."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Simulation Tests:"})," Run the ZPLC Runtime on a desktop target (POSIX/Win32) to verify behavior without hardware."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Hardware-in-the-Loop (HIL) - ",(0,s.jsx)(n.em,{children:'The "Real" Test'}),":"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Setup:"})," One Zephyr board (e.g., ESP32 or STM32) connected via USB to a runner."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tooling:"})," Use ",(0,s.jsxs)(n.strong,{children:["Zephyr's ",(0,s.jsx)(n.code,{children:"twister"})]})," script."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rule:"}),' Code is not "done" until it runs on the physical board in the pipeline.']}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"2-phase-by-phase-verification",children:"2. Phase-by-Phase Verification"}),"\n",(0,s.jsx)(n.h3,{id:"phase-0-core-skeleton--build-system",children:"Phase 0: Core Skeleton & Build System"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cross-Compilation Check:"})," CI builds for Linux, Windows, Zephyr-STM32, Zephyr-ESP32, and WASM."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"HAL Contract Test:"})," Verify ",(0,s.jsx)(n.code,{children:"zplc_hal_sleep(100)"})," waits approximately 100ms."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"phase-1-st-compiler--vm-instruction-set",children:"Phase 1: ST Compiler & VM Instruction Set"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Opcode Unit Tests:"})," Hundreds of tiny C tests checking every VM instruction."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:'Compiler "Golden Files":'})," Compare generated ",(0,s.jsx)(n.code,{children:".zplc"}),' binary against known "perfect" binary.']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"IEC Compliance Suite (Math):"})," Implement IEC 61131-3 math examples and assert output."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"phase-2-visual-languages",children:"Phase 2: Visual Languages"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Topological Sort Test:"})," Ensure compiler sorts execution order correctly."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Round-Trip Test:"})," ",(0,s.jsx)(n.code,{children:"Import XML"})," -> ",(0,s.jsx)(n.code,{children:"Internal Model"})," -> ",(0,s.jsx)(n.code,{children:"Export XML"})," parity."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"phase-3-runtime-maturity",children:"Phase 3: Runtime Maturity"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Jitter Test:"})," Measure variance on GPIO toggle."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Power-Loss Test:"})," Verify program restoration from NVS."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Watchdog Test:"})," Verify detection of infinite loops."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"phase-4-connectivity--security",children:"Phase 4: Connectivity & Security"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Fuzzing:"})," Blast Modbus/Loader ports with garbage data."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Network Storm:"})," Flood network while controlling IO."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Authentication Check:"})," Ensure unauthorized uploads fail."]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);