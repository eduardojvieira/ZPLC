"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[5716],{4443(e,n,i){i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"advanced/debugging","title":"Debugging","description":"Advanced debugging features - breakpoints, watch variables, and step execution","source":"@site/docs/advanced/debugging.md","sourceDirName":"advanced","slug":"/advanced/debugging","permalink":"/ZPLC/docs/advanced/debugging","draft":false,"unlisted":false,"editUrl":"https://github.com/eduardojvieira/ZPLC/tree/master/docs/docs/advanced/debugging.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Debugging","description":"Advanced debugging features - breakpoints, watch variables, and step execution"},"sidebar":"docsSidebar","previous":{"title":"Multitasking","permalink":"/ZPLC/docs/advanced/multitask"}}');var l=i(4848),r=i(8453);const d={sidebar_position:2,title:"Debugging",description:"Advanced debugging features - breakpoints, watch variables, and step execution"},c="Debugging Guide",t={},a=[{value:"Debug Architecture",id:"debug-architecture",level:2},{value:"Debug Modes",id:"debug-modes",level:2},{value:"1. WASM Simulation (In-Browser)",id:"1-wasm-simulation-in-browser",level:3},{value:"2. Serial Debug (Hardware)",id:"2-serial-debug-hardware",level:3},{value:"Setting Breakpoints",id:"setting-breakpoints",level:2},{value:"In the IDE",id:"in-the-ide",level:3},{value:"Breakpoint Types",id:"breakpoint-types",level:3},{value:"Conditional Breakpoints",id:"conditional-breakpoints",level:3},{value:"Watch Variables",id:"watch-variables",level:2},{value:"Adding Watches",id:"adding-watches",level:3},{value:"Watch Expression Syntax",id:"watch-expression-syntax",level:3},{value:"Live Updates",id:"live-updates",level:3},{value:"Debug Toolbar",id:"debug-toolbar",level:2},{value:"Memory Inspector",id:"memory-inspector",level:2},{value:"Memory Regions",id:"memory-regions",level:3},{value:"Shell Commands (Serial Debug)",id:"shell-commands-serial-debug",level:3},{value:"Forcing Variables",id:"forcing-variables",level:2},{value:"In the IDE",id:"in-the-ide-1",level:3},{value:"Via Shell",id:"via-shell",level:3},{value:"Release Forces",id:"release-forces",level:3},{value:"Debug Map (Source Mapping)",id:"debug-map-source-mapping",level:2},{value:"Debug Map Format",id:"debug-map-format",level:3},{value:"Enabling Debug Info",id:"enabling-debug-info",level:3},{value:"Cycle-by-Cycle Debugging",id:"cycle-by-cycle-debugging",level:2},{value:"Understanding the Scan Cycle",id:"understanding-the-scan-cycle",level:3},{value:"Step Modes",id:"step-modes",level:3},{value:"Timing Display",id:"timing-display",level:3},{value:"Debugging Multitask Programs",id:"debugging-multitask-programs",level:2},{value:"Task Selection",id:"task-selection",level:3},{value:"Global vs Local Variables",id:"global-vs-local-variables",level:3},{value:"Cross-Task Inspection",id:"cross-task-inspection",level:3},{value:"Performance Profiling",id:"performance-profiling",level:2},{value:"Cycle Time Histogram",id:"cycle-time-histogram",level:3},{value:"Identifying Bottlenecks",id:"identifying-bottlenecks",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Breakpoint Not Hitting",id:"breakpoint-not-hitting",level:3},{value:"Variables Show Wrong Values",id:"variables-show-wrong-values",level:3},{value:"Serial Debug Disconnects",id:"serial-debug-disconnects",level:3},{value:"WASM Simulation Differs from Hardware",id:"wasm-simulation-differs-from-hardware",level:3},{value:"Enhanced Debug Commands (v1.1+)",id:"enhanced-debug-commands-v11",level:2},{value:"<code>zplc dbg ticks</code>",id:"zplc-dbg-ticks",level:3},{value:"<code>zplc dbg mem &lt;region&gt; [offset]</code>",id:"zplc-dbg-mem-region-offset",level:3},{value:"<code>zplc dbg task &lt;id&gt; [--json]</code>",id:"zplc-dbg-task-id---json",level:3},{value:"<code>zplc dbg watch &lt;addr&gt; [type]</code>",id:"zplc-dbg-watch-addr-type",level:3},{value:"<code>zplc dbg timer &lt;addr&gt;</code>",id:"zplc-dbg-timer-addr",level:3}];function o(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"debugging-guide",children:"Debugging Guide"})}),"\n",(0,l.jsx)(n.p,{children:"ZPLC provides professional-grade debugging capabilities that work both in simulation (WASM) and on real hardware via serial connection."}),"\n",(0,l.jsx)(n.h2,{id:"debug-architecture",children:"Debug Architecture"}),"\n",(0,l.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant IDE as ZPLC IDE\n    participant DA as Debug Adapter\n    participant RT as Runtime (WASM/Serial)\n    \n    IDE->>DA: Set Breakpoint (line 42)\n    DA->>RT: DBG BREAK 0x0156\n    RT--\x3e>DA: ACK\n    \n    Note over RT: Execution hits breakpoint\n    RT--\x3e>DA: PAUSED @ 0x0156\n    DA--\x3e>IDE: Stopped (line 42)\n    \n    IDE->>DA: Read Variables\n    DA->>RT: DBG PEEK 0x2000 64\n    RT--\x3e>DA: [variable data]\n    DA--\x3e>IDE: Update Watch Window\n    \n    IDE->>DA: Step\n    DA->>RT: DBG STEP\n    RT--\x3e>DA: PAUSED @ 0x015A\n    DA--\x3e>IDE: Stopped (line 43)"}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"debug-modes",children:"Debug Modes"}),"\n",(0,l.jsx)(n.h3,{id:"1-wasm-simulation-in-browser",children:"1. WASM Simulation (In-Browser)"}),"\n",(0,l.jsx)(n.p,{children:"The fastest way to debug - no hardware required."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Advantages:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Instant startup"}),"\n",(0,l.jsx)(n.li,{children:"Unlimited breakpoints"}),"\n",(0,l.jsx)(n.li,{children:"Full memory inspection"}),"\n",(0,l.jsx)(n.li,{children:"Deterministic timing"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Limitations:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"No real I/O"}),"\n",(0,l.jsx)(n.li,{children:"Simulated timers (accelerated)"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"2-serial-debug-hardware",children:"2. Serial Debug (Hardware)"}),"\n",(0,l.jsx)(n.p,{children:"Connect to real hardware via USB serial."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Advantages:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Real I/O"}),"\n",(0,l.jsx)(n.li,{children:"Actual timing behavior"}),"\n",(0,l.jsx)(n.li,{children:"Tests real memory constraints"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Limitations:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Single breakpoint at a time"}),"\n",(0,l.jsx)(n.li,{children:"Slower variable updates"}),"\n",(0,l.jsx)(n.li,{children:"Requires USB connection"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"setting-breakpoints",children:"Setting Breakpoints"}),"\n",(0,l.jsx)(n.h3,{id:"in-the-ide",children:"In the IDE"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Click the gutter (line number area) to set a breakpoint"}),"\n",(0,l.jsx)(n.li,{children:"Red dot indicates active breakpoint"}),"\n",(0,l.jsx)(n.li,{children:"Right-click for conditions (conditional breakpoints)"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"breakpoint-types",children:"Breakpoint Types"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Type"}),(0,l.jsx)(n.th,{children:"Icon"}),(0,l.jsx)(n.th,{children:"Description"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Line"})}),(0,l.jsx)(n.td,{children:"\ud83d\udd34"}),(0,l.jsx)(n.td,{children:"Pause when line is reached"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Conditional"})}),(0,l.jsx)(n.td,{children:"\ud83d\udfe1"}),(0,l.jsx)(n.td,{children:"Pause when condition is true"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Logpoint"})}),(0,l.jsx)(n.td,{children:"\ud83d\udd35"}),(0,l.jsx)(n.td,{children:"Log message without pausing"})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"conditional-breakpoints",children:"Conditional Breakpoints"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-st",children:"(* Break only when counter reaches specific value *)\ncounter := counter + 1;  // Breakpoint: counter = 100\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"watch-variables",children:"Watch Variables"}),"\n",(0,l.jsx)(n.h3,{id:"adding-watches",children:"Adding Watches"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Open the ",(0,l.jsx)(n.strong,{children:"Watch"})," panel in the IDE"]}),"\n",(0,l.jsxs)(n.li,{children:["Click ",(0,l.jsx)(n.strong,{children:"+"})," to add a variable"]}),"\n",(0,l.jsx)(n.li,{children:"Type the variable name or drag from editor"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"watch-expression-syntax",children:"Watch Expression Syntax"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"variable_name           (* Simple variable *)\nfb_instance.output      (* Function block output *)\n%IX0.0                  (* Direct I/O address *)\narray[5]                (* Array element *)\nstruct.field            (* Structure field *)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"live-updates",children:"Live Updates"}),"\n",(0,l.jsx)(n.p,{children:"When connected to a running program:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Green"})," values: Recently changed"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"White"})," values: Stable"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Red"})," values: Out of range / error"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"debug-toolbar",children:"Debug Toolbar"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Button"}),(0,l.jsx)(n.th,{children:"Shortcut"}),(0,l.jsx)(n.th,{children:"Action"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:["\u25b6\ufe0f ",(0,l.jsx)(n.strong,{children:"Run"})]}),(0,l.jsx)(n.td,{children:"F5"}),(0,l.jsx)(n.td,{children:"Start/resume execution"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:["\u23f8\ufe0f ",(0,l.jsx)(n.strong,{children:"Pause"})]}),(0,l.jsx)(n.td,{children:"F6"}),(0,l.jsx)(n.td,{children:"Pause at current cycle"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:["\u23f9\ufe0f ",(0,l.jsx)(n.strong,{children:"Stop"})]}),(0,l.jsx)(n.td,{children:"Shift+F5"}),(0,l.jsx)(n.td,{children:"Stop execution"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:["\u23ed\ufe0f ",(0,l.jsx)(n.strong,{children:"Step Over"})]}),(0,l.jsx)(n.td,{children:"F10"}),(0,l.jsx)(n.td,{children:"Execute one line"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:["\u23ec ",(0,l.jsx)(n.strong,{children:"Step Into"})]}),(0,l.jsx)(n.td,{children:"F11"}),(0,l.jsx)(n.td,{children:"Step into function"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:["\u23eb ",(0,l.jsx)(n.strong,{children:"Step Out"})]}),(0,l.jsx)(n.td,{children:"Shift+F11"}),(0,l.jsx)(n.td,{children:"Run until function returns"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:["\ud83d\udd04 ",(0,l.jsx)(n.strong,{children:"Restart"})]}),(0,l.jsx)(n.td,{children:"Ctrl+Shift+F5"}),(0,l.jsx)(n.td,{children:"Reset and start again"})]})]})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"memory-inspector",children:"Memory Inspector"}),"\n",(0,l.jsx)(n.p,{children:"Access raw memory for advanced debugging."}),"\n",(0,l.jsx)(n.h3,{id:"memory-regions",children:"Memory Regions"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Region"}),(0,l.jsx)(n.th,{children:"Address Range"}),(0,l.jsx)(n.th,{children:"Description"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"IPI"}),(0,l.jsx)(n.td,{children:"0x0000 - 0x0FFF"}),(0,l.jsx)(n.td,{children:"Input Process Image"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"OPI"}),(0,l.jsx)(n.td,{children:"0x1000 - 0x1FFF"}),(0,l.jsx)(n.td,{children:"Output Process Image"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Work"}),(0,l.jsx)(n.td,{children:"0x2000 - 0x3FFF"}),(0,l.jsx)(n.td,{children:"Task working memory"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Retain"}),(0,l.jsx)(n.td,{children:"0x4000 - 0x4FFF"}),(0,l.jsx)(n.td,{children:"Retentive (NVS-backed)"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Code"}),(0,l.jsx)(n.td,{children:"0x5000 - 0xFFFF"}),(0,l.jsx)(n.td,{children:"Bytecode"})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"shell-commands-serial-debug",children:"Shell Commands (Serial Debug)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Pause execution\nzplc dbg pause\n\n# Resume execution\nzplc dbg resume\n\n# Step one cycle\nzplc dbg step\n\n# Read memory (hex dump)\nzplc dbg peek 0x2000 32\n# Output:\n# 0x2000: 00 00 00 00 01 00 00 00  ........\n# 0x2008: E8 03 00 00 00 00 80 3F  .......?\n# 0x2010: 00 00 00 00 00 00 00 00  ........\n# 0x2018: FF FF FF FF 00 00 00 00  ........\n\n# Write memory (for forcing values)\nzplc dbg poke 0x2000 01\nzplc dbg poke 0x2004 E803  # Write 1000 (0x03E8) as little-endian\n\n# Show VM state\nzplc dbg info\n# Output:\n# VM State: PAUSED\n# PC: 0x0156\n# SP: 4\n# Stack[0]: 00000001\n# Stack[1]: 000003E8\n# Stack[2]: 3F800000\n# Stack[3]: 00000000\n# Flags: Z=0 N=0 C=0 V=0\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"forcing-variables",children:"Forcing Variables"}),"\n",(0,l.jsx)(n.p,{children:"Override variable values during debugging:"}),"\n",(0,l.jsx)(n.h3,{id:"in-the-ide-1",children:"In the IDE"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Right-click a variable in Watch panel"}),"\n",(0,l.jsxs)(n.li,{children:["Select ",(0,l.jsx)(n.strong,{children:"Force Value"})]}),"\n",(0,l.jsx)(n.li,{children:"Enter new value"}),"\n",(0,l.jsx)(n.li,{children:"Variable shows \ud83d\udd12 icon when forced"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"via-shell",children:"Via Shell"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Force a BOOL at address 0x2000\nzplc dbg poke 0x2000 01\n\n# Force an INT (little-endian) at address 0x2004\nzplc dbg poke 0x2004 E803  # 1000 decimal\n\n# Force a REAL (IEEE 754) at address 0x2008\nzplc dbg poke 0x2008 00008040  # 4.0 as float\n"})}),"\n",(0,l.jsx)(n.h3,{id:"release-forces",children:"Release Forces"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# In IDE: Right-click \u2192 Release Force\n# Via shell: Write original value back\n"})}),"\n",(0,l.jsx)(n.admonition,{title:"Production Safety",type:"warning",children:(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Never force safety-critical values in production!"})," Forces bypass normal logic and can cause dangerous conditions."]})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"debug-map-source-mapping",children:"Debug Map (Source Mapping)"}),"\n",(0,l.jsx)(n.p,{children:"The compiler generates debug maps linking bytecode addresses to source lines."}),"\n",(0,l.jsx)(n.h3,{id:"debug-map-format",children:"Debug Map Format"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "version": 1,\n  "file": "main.st",\n  "mappings": [\n    { "pc": 0, "line": 5, "column": 1 },\n    { "pc": 12, "line": 6, "column": 1 },\n    { "pc": 24, "line": 8, "column": 5 },\n    ...\n  ],\n  "variables": [\n    { "name": "counter", "address": 8192, "type": "INT", "scope": "global" },\n    { "name": "motor_on", "address": 8194, "type": "BOOL", "scope": "global" },\n    ...\n  ]\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"enabling-debug-info",children:"Enabling Debug Info"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Compile with debug info\nbun run compile --project ./myproject --debug\n\n# Or in IDE: Settings \u2192 Compiler \u2192 Include Debug Info \u2713\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"cycle-by-cycle-debugging",children:"Cycle-by-Cycle Debugging"}),"\n",(0,l.jsx)(n.h3,{id:"understanding-the-scan-cycle",children:"Understanding the Scan Cycle"}),"\n",(0,l.jsx)(n.mermaid,{value:'graph LR\n    subgraph "One Scan Cycle"\n        A[Read Inputs] --\x3e B[Execute Logic]\n        B --\x3e C[Update Outputs]\n        C --\x3e D[Housekeeping]\n    end\n    D --\x3e A'}),"\n",(0,l.jsx)(n.h3,{id:"step-modes",children:"Step Modes"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Mode"}),(0,l.jsx)(n.th,{children:"Behavior"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Step Cycle"})}),(0,l.jsx)(n.td,{children:"Execute one complete scan cycle"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Step Line"})}),(0,l.jsx)(n.td,{children:"Execute one ST line (may span multiple opcodes)"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Step Instruction"})}),(0,l.jsx)(n.td,{children:"Execute one VM opcode"})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"timing-display",children:"Timing Display"}),"\n",(0,l.jsx)(n.p,{children:"When paused, the IDE shows:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cycle Time"}),": Last scan duration"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cycle Count"}),": Total scans executed"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Uptime"}),": Total runtime"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"debugging-multitask-programs",children:"Debugging Multitask Programs"}),"\n",(0,l.jsx)(n.p,{children:"With multiple tasks, debugging requires care:"}),"\n",(0,l.jsx)(n.h3,{id:"task-selection",children:"Task Selection"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Select which task to debug in the ",(0,l.jsx)(n.strong,{children:"Tasks"})," dropdown"]}),"\n",(0,l.jsx)(n.li,{children:"Breakpoints are task-specific"}),"\n",(0,l.jsx)(n.li,{children:"Watch shows variables from selected task"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"global-vs-local-variables",children:"Global vs Local Variables"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-st",children:"(* Global - visible to all tasks *)\nVAR_GLOBAL\n    shared_speed : REAL;\nEND_VAR\n\n(* Local - visible only in this task *)\nVAR\n    local_counter : INT;\nEND_VAR\n"})}),"\n",(0,l.jsx)(n.h3,{id:"cross-task-inspection",children:"Cross-Task Inspection"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Pause all tasks: ",(0,l.jsx)(n.code,{children:"zplc dbg pause"})]}),"\n",(0,l.jsx)(n.li,{children:"Switch task in dropdown"}),"\n",(0,l.jsx)(n.li,{children:"Inspect that task's variables"}),"\n",(0,l.jsxs)(n.li,{children:["Resume: ",(0,l.jsx)(n.code,{children:"zplc dbg resume"})]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"performance-profiling",children:"Performance Profiling"}),"\n",(0,l.jsx)(n.h3,{id:"cycle-time-histogram",children:"Cycle Time Histogram"}),"\n",(0,l.jsxs)(n.p,{children:["The IDE's ",(0,l.jsx)(n.strong,{children:"Performance"})," panel shows:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Min/Max/Average cycle time"}),"\n",(0,l.jsx)(n.li,{children:"Histogram of cycle durations"}),"\n",(0,l.jsx)(n.li,{children:"Overrun count"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"identifying-bottlenecks",children:"Identifying Bottlenecks"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-st",children:"(* Add timing markers *)\nVAR\n    t_start : TIME;\n    t_section1 : TIME;\n    t_section2 : TIME;\nEND_VAR\n\nt_start := UPTIME();\n\n(* Section 1: Input processing *)\nprocess_inputs();\nt_section1 := UPTIME() - t_start;\n\n(* Section 2: Control logic *)\ncontrol_loop();\nt_section2 := UPTIME() - t_start - t_section1;\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h3,{id:"breakpoint-not-hitting",children:"Breakpoint Not Hitting"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Verify code is reachable (check conditions)"}),"\n",(0,l.jsx)(n.li,{children:"Ensure debug info is included"}),"\n",(0,l.jsx)(n.li,{children:"Check correct task is selected"}),"\n",(0,l.jsx)(n.li,{children:"Rebuild with clean compile"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"variables-show-wrong-values",children:"Variables Show Wrong Values"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Check variable address in debug map"}),"\n",(0,l.jsx)(n.li,{children:"Verify correct data type interpretation"}),"\n",(0,l.jsx)(n.li,{children:"Check for race conditions in multitask"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"serial-debug-disconnects",children:"Serial Debug Disconnects"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Reduce Watch variable count"}),"\n",(0,l.jsx)(n.li,{children:"Increase serial timeout"}),"\n",(0,l.jsx)(n.li,{children:"Check USB cable quality"}),"\n",(0,l.jsx)(n.li,{children:"Lower baud rate if noise issues"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"wasm-simulation-differs-from-hardware",children:"WASM Simulation Differs from Hardware"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Timer behavior differs (WASM is faster)"}),"\n",(0,l.jsx)(n.li,{children:"I/O values are simulated"}),"\n",(0,l.jsx)(n.li,{children:"Memory layout may differ slightly"}),"\n",(0,l.jsx)(n.li,{children:"Always final-test on real hardware"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"enhanced-debug-commands-v11",children:"Enhanced Debug Commands (v1.1+)"}),"\n",(0,l.jsx)(n.p,{children:"ZPLC v1.1 introduces powerful new debugging commands for troubleshooting PLC programs:"}),"\n",(0,l.jsx)(n.h3,{id:"zplc-dbg-ticks",children:(0,l.jsx)(n.code,{children:"zplc dbg ticks"})}),"\n",(0,l.jsx)(n.p,{children:"Shows the current system tick value in milliseconds."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"uart:~$ zplc dbg ticks\nTicks: 12345 ms\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use case:"})," Verify that the system timer is progressing correctly, essential for debugging timer-based logic (TON, TOF, TP)."]}),"\n",(0,l.jsx)(n.h3,{id:"zplc-dbg-mem-region-offset",children:(0,l.jsx)(n.code,{children:"zplc dbg mem <region> [offset]"})}),"\n",(0,l.jsx)(n.p,{children:"Dumps memory regions with hex and ASCII representation."}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Regions:"})," ",(0,l.jsx)(n.code,{children:"ipi"}),", ",(0,l.jsx)(n.code,{children:"opi"}),", ",(0,l.jsx)(n.code,{children:"work"}),", ",(0,l.jsx)(n.code,{children:"retain"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"uart:~$ zplc dbg mem work\n--- work Memory Dump (offset 0x0000) ---\n2000: 09 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  | ................\n2010: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  | ................\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use case:"})," Quick inspection of memory regions without manual ",(0,l.jsx)(n.code,{children:"peek"})," commands. Shows 64 bytes by default."]}),"\n",(0,l.jsx)(n.h3,{id:"zplc-dbg-task-id---json",children:(0,l.jsx)(n.code,{children:"zplc dbg task <id> [--json]"})}),"\n",(0,l.jsx)(n.p,{children:"Displays detailed information about a specific task."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"uart:~$ zplc dbg task 0\nTask 0:\n  Interval:   10000 us\n  Priority:   1\n  Cycles:     4089\n  Entry:      0x0000\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use case:"})," Debug why a task may be stalled. Confirm cycle count is incrementing."]}),"\n",(0,l.jsx)(n.h3,{id:"zplc-dbg-watch-addr-type",children:(0,l.jsx)(n.code,{children:"zplc dbg watch <addr> [type]"})}),"\n",(0,l.jsx)(n.p,{children:"Reads and displays typed values from memory addresses."}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Supported types:"})," ",(0,l.jsx)(n.code,{children:"u8"}),", ",(0,l.jsx)(n.code,{children:"u16"}),", ",(0,l.jsx)(n.code,{children:"u32"}),", ",(0,l.jsx)(n.code,{children:"i8"}),", ",(0,l.jsx)(n.code,{children:"i16"}),", ",(0,l.jsx)(n.code,{children:"i32"}),", ",(0,l.jsx)(n.code,{children:"bool"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"uart:~$ zplc dbg watch 0x2000 u32\n0x2000 (U32): 500 (0x000001F4)\n\nuart:~$ zplc dbg watch 0x1000 bool\n0x1000 (BOOL): TRUE\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use case:"})," Monitor specific variables during runtime without hex conversion."]}),"\n",(0,l.jsx)(n.h3,{id:"zplc-dbg-timer-addr",children:(0,l.jsx)(n.code,{children:"zplc dbg timer <addr>"})}),"\n",(0,l.jsx)(n.p,{children:"Specialized inspector for TON/TOF/TP timer function blocks."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"uart:~$ zplc dbg timer 0x2000\nTimer at 0x2000:\n  IN:      ON\n  Q:       OFF\n  PT:      500 ms\n  ET:      250 ms\n  _start:  12000 ms\n  _active: YES\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use case:"})," Debug IEC 61131-3 timer issues. Shows all timer state variables in one command."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}}}]);